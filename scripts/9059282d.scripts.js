"use strict";var mddtestSite=angular.module("mddtestSiteApp",["ngCookies","ngResource","ngRoute","firebase","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home/home.html",controller:"HomeCtrl"}).when("/login",{templateUrl:"views/login/login.html",controller:"LoginCtrl"}).when("/subjects/:id",{templateUrl:"views/subjectsList/subjectsList.html",controller:"SubjectlistCtrl"}).when("/subjects/:id/articles/:id",{templateUrl:"views/articleDetail/articleDetail.html",controller:"ArticledetailCtrl"}).otherwise({redirectTo:"/"})}]);mddtestSite.run(["$firebaseSimpleLogin","$rootScope","checklogin","$location",function(a,b,c,d){var e=new Firebase("https://mddproj.firebaseio.com/");b.loginObj=a(e),b.$on("$routeChangeStart",function(){console.log("route change start watch"),c.isLoggedIn()?console.log("Authenticated"):(console.log("Reject Login"),event.preventDefault(),d.path("/login"))})}]),angular.module("mddtestSiteApp").controller("ArticledetailCtrl",["$scope","$location","$firebase","checklogin",function(a,b,c,d){d.isLoggedIn();var e="https://mddproj.firebaseio.com"+b.$$path;a.items=c(new Firebase(e))}]),angular.module("mddtestSiteApp").controller("HomeCtrl",["$scope","$location","$rootScope","$firebase","checklogin",function(a,b,c,d,e){e.isLoggedIn(),a.newSub=!1;var f="https://mddproj.firebaseio.com/subjects";a.items=d(new Firebase(f)),a.items.$bind(a,"remoteItems"),a.addSubject=function(){a.newSub=!0},a.backLink=function(){a.newSub=!1},a.submitNewSubject=function(){var b="https://mddproj.firebaseio.com/subjects";a.subjectsHome=d(new Firebase(b)),a.subjectsHome.$add(a.mainSubjects),delete a.subjectHome,a.newSub=!1},a.subjectClicked=function(){var a="/subjects/"+this.$id;c.currentSelection=a,b.path(a)}}]),angular.module("mddtestSiteApp").controller("LoginCtrl",["$scope","$rootScope","$location","checklogin",function(a,b,c,d){a.attemptLogin=function(){b.loginObj.$login("facebook").then(function(){var a=b.loginObj.user.username;d.setUser(a);var e=d.isLoggedIn();if(e){var f="/home";c.path(f)}})}}]),angular.module("mddtestSiteApp").controller("SubjectlistCtrl",["$scope","$routeParams","$location","$rootScope","$firebase","checklogin",function(a,b,c,d,e,f){f.isLoggedIn(),d.forSwapToggle=!0;var g="https://mddproj.firebaseio.com/"+b.id+"/articles";a.items=e(new Firebase(g)),a.formSwap=function(){d.formSwapToggle=d.formSwapToggle===!0?!1:!0},a.goToDetail=function(){var a="/subjects/"+b.id+"/articles/"+this.$id;c.path(a)}}]),angular.module("mddtestSiteApp").directive("navbar",function(){return{templateUrl:"views/nav/navBar.html",restrict:"E",controller:["$rootScope","$location","checklogin","$scope",function(a,b,c,d){console.log(a.loginObj),a.logUserOut=function(){a.loginObj.$logout(),c.setUser(),c.isLoggedIn();var d="/login";b.path(d)},d.takeMeHome=function(){var a="/home";b.path(a)}}],link:function(a,b,c,d){a.navToggle=!1,a.navStat=["snv-container-right","snv-container-push-toleft"],a.getStat=function(){var b="";return a.navToggle===!1?(b="snv-container-right",a.containerstat="main-container-push-open"):a.navToggle===!0&&(b="snv-container-right-open",d.containerStat="main-container-push"),b},a.barToggle=function(){a.navToggle===!1?a.navToggle=!0:a.navToggle===!0&&(a.navToggle=!1)},a.hideBar=function(){a.barToggle(),a.getStat()},a.optionsClick=function(){a.barToggle(),a.getStat()}}}}),angular.module("mddtestSiteApp").directive("newSubForm",function(){return{templateUrl:"views/directives/newSubForm.html",restrict:"E",controller:["$scope","$firebase","$rootScope","$location","$routeParams",function(a,b,c,d,e){a.inputPrompt=!0,a.master={},a.mainArticle=[],a.article={},a.formStage=!0;var f="http://mddproj.firebaseio.com/subjects/"+e.id+"/articles";console.log(f),a.items=b(new Firebase(f)),a.items.$bind(a,"remoteItems"),a.formStageSet=function(){a.formStage=a.formStage===!0?!1:!0},a.toggleBack=function(){c.formSwapToggle=!1},a.appendToArticle=function(){a.inputPrompt=!1,!a.NUSubject.comment||/^\s*$/.test(a.NUSubject.comment)?console.log("comment broke"):(a.mainArticle.push({type:"NUSMessage",message:a.NUSubject.comment}),a.NUSubject.comment=""),!a.NUSubject.webLink||/^\s*$/.test(a.NUSubject.webLink)||(a.mainArticle.push({type:"NUSLink",message:a.NUSubject.webLink}),a.NUSubject.webLink="")},a.saveProject=function(){console.log(c.loginObj.user.displayName),a.article.author=c.loginObj.user.displayName,a.article.articleTitle=a.NUSubject.title,a.article.message=a.mainArticle,console.log(a.article),a.items.$add(a.article),a.article=angular.copy(a.master),a.NUSubject.title="",a.mainArticle={},a.formStageSet(),c.formSwapToggle=!1}}],link:function(){}}}),angular.module("mddtestSiteApp").factory("checklogin",function(){var a;return{setUser:function(b){a=b,console.log(a)},isLoggedIn:function(){var b;return b=a?!0:!1}}});